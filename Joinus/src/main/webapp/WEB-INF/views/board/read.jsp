<%@ page language="java" contentType="text/html; charset=UTF-8"
         pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<!DOCTYPE html>
<html>
<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta
          name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />
  <!-- Site Metas -->
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />

  <title>Energym</title>

  <!-- slider stylesheet -->
  <link
          rel="stylesheet"
          type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.1.3/assets/owl.carousel.min.css"
  />
  <script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E=" crossorigin="anonymous"></script>
  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="../../../resources/css/bootstrap.css" />

  <!-- fonts style -->
  <link
          href="https://fonts.googleapis.com/css?family=Baloo+Chettan|Dosis:400,600,700|Poppins:400,600,700&display=swap"
          rel="stylesheet"
  />
  <!-- Custom styles for this template -->
  <link href="../../../resources/css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="../../../resources/css/responsive.css" rel="stylesheet" />
</head>
<style>
  .tab {
    overflow: hidden;
      border-top: 1px solid #e7e7e7; /* ÏúÑÏ™ΩÏóê Í≤ÄÏùÄÏÉâ ÌÖåÎëêÎ¶¨ Ï∂îÍ∞Ä */
      border-bottom: 2px solid black; /* ÏïÑÎûòÏ™ΩÏóê Í≤ÄÏùÄÏÉâ ÌÖåÎëêÎ¶¨ Ï∂îÍ∞Ä */
    background-color: #ffffff;
  }
  .tab button {
    background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
    font-size: 17px;
  }
  .tab button:hover {
    background-color: #ddd;
  }
  .tab button.active {
    background-color: #ffffff;
  }
  .tabcontent {
    display: none;
    padding: 6px 12px;
    border: 1px solid #ccc;
    border-top: none;
  }
  .plcc_banner img {
      display: block;
      width: 100%;
  }
  .plcc_banner img {
      vertical-align: top;
  }
  .plcc_banner img {
      border: 0 none;
  }
  .plcc_banner img {
      border: 0;
      -ms-interpolation-mode: bicubic;
  }
  .btnbasket{
      height: 50px;
      width: 248px;
      background-color: #ffffff;
      border: 1px solid #000000;
      font-weight: bold;

  }
  .btnpurchase{
      height: 50px;
      width: 248px;
      background-color: #ff731b;
      border: none;
      font-weight: bold;
      color: white;
  }
  .btnwarning{
      height: 50px;
      width: 50px;
      border:none;
      border-radius: 10px;
      background-color: #ffc59b;

  }
  #qnaForm {
      margin-bottom: 20px;
  }

  #qnaTextarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      resize: vertical;
  }

  #qnaForm button {
      padding: 8px 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
  }

  #qnaForm button:hover {
      background-color: #45a049;
  }

  .inquiry {
      background-color: #f7f7f7;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
  }

  .inquiry p {
      margin: 0;
      padding: 0;
  }

  .inquiry-text {
      font-weight: bold;
  }

  .inquiry-date {
      color: #888;
      font-size: 12px;
  }
  .btn-inquiry{
      width: 560px;
      height: 60px;
      border: none;
      background-color: #ff731b;
      border-radius: 5px;
      font-size: 17px;
      color: white;
      font-weight: bold;
  }
  #inquiryButton{
      width: 100px;
      height: 40px;
      border: none;
      background-color: #ff731b;
      border-radius: 5px;
      font-size: 17px;
      color: white;
      font-weight: bold;
  }
  .inquiry-Content{
      width: 1110px;
      border: 1px solid #c9c9c9;
  }
  .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.4);
  }

  .modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 600px;
  }

  .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
  }

  .close:hover,
  .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
  }

</style>
<%@ include file="../header/header.jsp"%>
<body class="sub_page about_page">
<table id="datatable-scroller"
       class="table table-bordered tbl_Form">
  <colgroup>
    <col width="250px" />
    <col />
  </colgroup>
  <tbody>
  <div class="container mt-5">
      <div class="row">
          <div class="col-md-6">
              <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                  <div class="carousel-inner">
                      <c:forEach items="${productVO.thumbnailList}" var="thumbnail" varStatus="status">
                          <c:if test="${status.index < 1}">
                              <div class="carousel-item active">
                                  <img src="/display?fileName=${thumbnail.uploadPath}/${thumbnail.uuid}_${thumbnail.fileName}" class="d-block w-100" width="50%" alt="...">
                              </div>
                          </c:if>
                          <c:if test="${status.index >= 1}">
                              <div class="carousel-item">
                                  <img src="/display?fileName=${thumbnail.uploadPath}/${thumbnail.uuid}_${thumbnail.fileName}"  class="d-block w-100" width="50%" alt="...">
                              </div>
                          </c:if>
                      </c:forEach>
                  </div>
                  <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                  </a>
                  <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                  </a>
              </div>
          </div>
      <div class="col-md-6">
          <div style="color: #8e8e8e">üè†Ô∏é ${store.s_name}</div>
          <hr>
        <h4>${productVO.p_inst }</h4>
        <form>
          <div class="form-group">
            <label for="colorSelect">Ï¢ÖÎ•ò</label>
            <select class="form-control" id="colorSelect">
              <option>${productVO.p_category}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="startDate">Í∏∞Í∞Ñ</label>
              <br>
              <c:if test="${productVO.p_type == 'fixed'}">
                  <input type="text" class="form-control" id="startDate" style="display: inline-block; width: 110px;" data-type="fixed" value="<fmt:formatDate value='${productVO.p_startDate}' pattern='yyyy-MM-dd' />">
                  <b style="display: inline-block; font-size: 25px; margin-right: 15px;">&nbsp&nbsp~</b>
                  <input type="text" class="form-control" id="endDate" style="display: inline-block; width: 110px;" data-type="fixed" value="<fmt:formatDate value='${productVO.p_endDate}' pattern='yyyy-MM-dd' />">

              </c:if>
              <c:if test="${productVO.p_type == 'free'}">
                  <input type="date" id="startDate" max="2099-12-31" data-type="free" class="period-startDate" style="width: 120px; margin-right: 15px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px;">
                  <b style="display: inline-block; font-size: 25px; margin-right: 15px;">~</b>
                  <input type="date" id="endDate" max="2099-12-31" data-type="free" class="period-endDate" style="width: 120px; margin-right: 15px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px;">
              </c:if>
          </div>
<%--          <div class="form-group">--%>
<%--            <label for="quantityInput">ÏàòÎüâ</label>--%>
<%--            <input type="number" class="form-control" id="quantityInput" value="1" onchange="updateTotalPrice()">--%>
<%--          </div>--%>
          <div class="form-group">
            <label for="totalPrice">Ï¥ù Í∞ÄÍ≤©</label>
            <input type="number" class="form-control" id="totalPrice" value="${productVO.p_price}" readonly>
          </div>
            <div class="plcc_banner">
                <img src="http://pics.auction.co.kr/vip/2022/2207_pc_vip_bn_img_01.png" alt="GÎßàÏºì" Ïò•ÏÖò="" Ïä§ÎßàÏùºÏπ¥Îìú="" ÏµúÎåÄ="" 2ÎßåÏõê="" ÌòúÌÉù!="">
            </div>
            <br>
          <c:choose>
            <c:when test="${like == 1}">
              <button type="button" class="btnwarning" id="wishBtn" data-a='${productVO.pno}' data-b='${customerUserVO.u_id}'>‚ù§Ô∏è</button>
            </c:when>
            <c:otherwise>
              <button type="button" class="btnwarning" id="wishBtn" data-a='${productVO.pno}' data-b='${customerUserVO.u_id}'>ü§ç</button>
            </c:otherwise>
          </c:choose>

          <c:choose>
            <c:when test="${cart == 1}">
              <button type="button" class="btnbasket" id="cartBtn" data-c='${productVO.pno}' data-d='${customerUserVO.u_id}'>üõí</button>
            </c:when>
            <c:otherwise>
              <button type="button" class="btnbasket" id="cartBtn" data-c='${productVO.pno}' data-d='${customerUserVO.u_id}'>Ïû•Î∞îÍµ¨Îãà</button>
            </c:otherwise>
          </c:choose>
          <button type="button" id="buyBtn" class="btnpurchase">Íµ¨Îß§ÌïòÍ∏∞</button>
        </form>
      </div>

    </div>
    <br>
    <!-- ÌÉ≠ Î≤ÑÌäº -->
    <div class="tab">
      <button class="tablinks" onclick="openTab(event, 'product_info')">ÏÉÅÌíà ÏÉÅÏÑ∏ Ï†ïÎ≥¥</button>
      <button class="tablinks" onclick="openTab(event, 'reviews')">Íµ¨Îß§ÌõÑÍ∏∞</button>
      <button class="tablinks" id="inquiryTab" onclick="openTab(event, 'qna')">ÏÉÅÌíàÎ¨∏Ïùò</button>
      <button class="tablinks" onclick="openTab(event, 'refund')">ÌôòÎ∂à</button>
    </div>
    <!-- ÌÉ≠ ÎÇ¥Ïö© -->
    <div id="product_info" class="tabcontent">
      <h3>ÏÉÅÌíà ÏÉÅÏÑ∏ Ï†ïÎ≥¥</h3>
        <img src="/display?fileName=${productVO.detail.uploadPath}/${productVO.detail.uuid}_${productVO.detail.fileName}">
    </div>

    <div id="reviews" class="tabcontent">
      <h3>Íµ¨Îß§ÌõÑÍ∏∞</h3>
      <p>Íµ¨Îß§ÌõÑÍ∏∞</p>
    </div>

      <div id="qna" class="tabcontent">
          <button id="inquiryButton">Î¨∏ÏùòÌïòÍ∏∞</button><hr>
          <div id="inquiryForm" class="modal">
              <div class="modal-content">
                  <span class="close">&times;</span>
                  <form id="qnaForm">
                      <textarea id="qnaTextarea" class="inquiry-Content" rows="4" cols="50" placeholder="ÏÉÅÌíà Î¨∏ÏùòÎ•º ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî"></textarea>
                      <button type="button" class="btn-inquiry" onclick="submitInquiry()">Î¨∏Ïùò Îì±Î°ù</button>
                  </form>
              </div>
          </div>
          <div id="editInquiryModal" class="modal">
              <div class="modal-content">
                  <span class="close">&times;</span>
                  <form id="editInquiryForm">
                      <textarea id="editInquiryTextarea" class="inquiry-Content" rows="4" cols="50" placeholder="Î¨∏Ïùò ÎÇ¥Ïö©ÏùÑ ÏàòÏ†ïÌï¥Ï£ºÏÑ∏Ïöî"></textarea>
                      <button type="button" class="btn-update-inquiry" onclick="updateInquiry()">ÏàòÏ†ï</button>
                  </form>
              </div>
          </div>
          <div id="qnaList">
              <!-- ÏÉÅÌíà Î¨∏Ïùò Î™©Î°ùÏù¥ ÌëúÏãúÎê† ÏòÅÏó≠ -->
          </div>
      </div>
      <div id="refund" class="tabcontent">
       <h3>ÌôòÎ∂à</h3>
      <div>
          <strong>[ÌôòÎ∂à Í∑úÏ†ï]</strong><br>
          <p>1. Ìã∞ÏºìÏùò ÏÇ¨Ïö©Í∏∞ÌïúÏúºÎ°úÎ∂ÄÌÑ∞ 10% Ïù¥ÎÇ¥Ïùò Í∏∞Í∞ÑÏù¥ ÏßÄÎÇú Í≤ΩÏö∞, ÌôòÎ∂àÏù¥ Î∂àÍ∞ÄÎä•Ìï©ÎãàÎã§.<br>
          2. ÌôòÎ∂àÏùÑ ÏõêÌïòÎäî Í≤ΩÏö∞, Íµ¨Îß§ÏûêÎäî Ìã∞ÏºìÌåêÎß§Ï†êÏóê Ïã†ÏÜçÌïòÍ≤å Î¨∏ÏùòÌï¥Ïïº Ìï©ÎãàÎã§.<br>
          3. ÌôòÎ∂à Ïã†Ï≤≠ÏùÄ ÏõêÎ≥∏ ÏòÅÏàòÏ¶ù ÎòêÎäî Íµ¨Îß§ ÌôïÏù∏ÏÑúÏôÄ Ìï®Íªò Ï†úÏ∂úÎêòÏñ¥Ïïº Ìï©ÎãàÎã§.<br>
          4. ÌôòÎ∂àÏùÄ ÏõêÎûò Í≤∞Ï†ú ÏàòÎã®ÏúºÎ°ú ÌôòÎ∂àÎêòÎ©∞, ÏõêÎûò Í≤∞Ï†ú Í∏àÏï°ÏóêÏÑú ÌôòÎ∂à ÏàòÏàòÎ£å ÎòêÎäî Ï≤òÎ¶¨ ÏàòÏàòÎ£åÍ∞Ä Í≥µÏ†úÎê† Ïàò ÏûàÏäµÎãàÎã§.<br>
          5. ÌôòÎ∂à Í∞ÄÎä•Ìïú Í∏àÏï°ÏùÄ Ìã∞Ïºì Í∞ÄÍ≤©ÏóêÏÑú ÌôòÎ∂à ÏàòÏàòÎ£å ÎòêÎäî Ï≤òÎ¶¨ ÏàòÏàòÎ£åÎ•º Í≥µÏ†úÌïú ÌõÑÏùò ÏûîÏï°ÏûÖÎãàÎã§.<br>
          6. Ìã∞ÏºìÏùÑ Îã§Î•∏ÏÇ¨ÎûåÏóêÍ≤å ÏñëÎèÑÌïòÍ±∞ÎÇò, ÏÇ¨Ïö©ÏûêÍ∞Ä Îã§Î•º Í≤ΩÏö∞  ÌôòÎ∂àÏù¥ Í±∞Î∂ÄÎê† Ïàò ÏûàÏäµÎãàÎã§.<br>
              7. Ìã∞ÏºìÌåêÎß§Ï†êÏùÄ Îã®ÎèÖÏúºÎ°ú ÌôòÎ∂à Í∑úÏ†ïÏùÑ Î≥ÄÍ≤ΩÌïòÍ±∞ÎÇò Ï∑®ÏÜåÌï† Í∂åÌïúÏùÑ Í∞ÄÏßëÎãàÎã§. Î≥ÄÍ≤ΩÎêú ÌôòÎ∂à Í∑úÏ†ïÏùÄ ÏÇ¨Ï†Ñ Í≥µÏßÄ ÌõÑ Ï†ÅÏö©Îê©ÎãàÎã§.</p>
          <br>
          <strong>[ÌôòÎ∂à ÏöîÏ≤≠]</strong><br>
          <p>- ÎßàÏù¥ÌéòÏù¥ÏßÄ -> ÌôòÎ∂àÏã†Ï≤≠
          - Íµ¨Îß§ÏûêÎäî ÌôòÎ∂àÏùÑ ÏõêÌïòÎäî Í≤ΩÏö∞ Í∞ÄÎä•Ìïú Îπ†Î•¥Í≤å Ìã∞ÏºìÌåêÎß§Ï†êÏóê Ïó∞ÎùΩÌïòÏó¨ ÌôòÎ∂à ÏöîÏ≤≠ÏùÑ ÏïåÎ†§Ïïº Ìï©ÎãàÎã§.<br>
              - ÌôòÎ∂à ÏöîÏ≤≠ÏùÄ Íµ¨Îß§Ìïú Ìã∞ÏºìÏùò Ï†ïÎ≥¥ÏôÄ Ìï®Íªò Ï†ÑÌôî, Ïù¥Î©îÏùº, Ïò®ÎùºÏù∏ ÏñëÏãù Îì±ÏùÑ ÌÜµÌï¥ Ï†úÏ∂úÎê† Ïàò ÏûàÏäµÎãàÎã§.<br></p>
          <br>
          <strong>[ÌôòÎ∂à Ïã†Ï≤≠ Í≤ÄÌÜ†]</strong><br>
          <p>- Ìã∞ÏºìÌåêÎß§Ï†êÏùÄ ÌôòÎ∂à Ïã†Ï≤≠ÏùÑ Í≤ÄÌÜ†ÌïòÍ≥†, ÌôòÎ∂à Í∞ÄÎä• Ïó¨Î∂ÄÎ•º ÌôïÏù∏Ìï©ÎãàÎã§.<br>
              - ÌôòÎ∂à Ïã†Ï≤≠Ïù¥ Ï†ëÏàòÎêòÎ©¥ Ìã∞ÏºìÏùò ÏÉÅÌÉúÏôÄ Íµ¨Îß§ ÎÇ¥Ïó≠ÏùÑ ÌôïÏù∏ÌïòÍ≥†, ÌôòÎ∂à Ï°∞Í±¥ÏùÑ Ï†ÅÏö©ÌïòÏó¨ Ï≤òÎ¶¨ Ïó¨Î∂ÄÎ•º Í≤∞Ï†ïÌï©ÎãàÎã§.<br></p>
          <br>
          <strong>[ÌôòÎ∂à ÏäπÏù∏]</strong><br>
          <p>- ÌôòÎ∂à Ïã†Ï≤≠Ïù¥ ÏäπÏù∏ÎêòÎ©¥ Ìã∞ÏºìÌåêÎß§Ï†êÏùÄ Íµ¨Îß§ÏûêÏóêÍ≤å ÌôòÎ∂à ÏäπÏù∏ÏùÑ ÌÜµÏßÄÌï©ÎãàÎã§.<br>
              - ÏäπÏù∏Îêú ÌôòÎ∂àÏùÄ ÏõêÎûò Í≤∞Ï†ú ÏàòÎã®ÏúºÎ°ú ÌôòÎ∂àÎê©ÎãàÎã§.<br></p>
          <br>
          <strong>[ÌôòÎ∂à Ï≤òÎ¶¨]</strong><br>
          <p>- ÌôòÎ∂à Ï≤òÎ¶¨ Îã®Í≥ÑÏóêÏÑúÎäî ÏõêÎûò Í≤∞Ï†ú Í∏àÏï°ÏóêÏÑú ÌôòÎ∂à ÏàòÏàòÎ£å ÎòêÎäî Ï≤òÎ¶¨ ÏàòÏàòÎ£åÎ•º Í≥µÏ†úÌïú ÌõÑÏùò ÏûîÏï°Ïù¥ Íµ¨Îß§ÏûêÏóêÍ≤å ÌôòÎ∂àÎê©ÎãàÎã§.<br>
              - ÌôòÎ∂à Ï≤òÎ¶¨ ÏãúÍ∞ÑÏùÄ ÏùºÎ∞òÏ†ÅÏúºÎ°ú Í≤∞Ï†ú ÏàòÎã®Í≥º ÌôòÎ∂à Î∞©Î≤ïÏóê Îî∞Îùº Îã§Î•º Ïàò ÏûàÏäµÎãàÎã§.<br></p>
          <br>
          <strong>[ÌôòÎ∂à ÏôÑÎ£å]</strong><br>
          <p>- ÌôòÎ∂àÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏôÑÎ£åÎêòÎ©¥ Ìã∞ÏºìÌåêÎß§Ï†êÏùÄ Íµ¨Îß§ÏûêÏóêÍ≤å ÌôòÎ∂à ÏôÑÎ£åÎ•º ÌÜµÏßÄÌï©ÎãàÎã§.<br>
              - Íµ¨Îß§ÏûêÎäî ÌôòÎ∂àÎêú Í∏àÏï°Ïù¥ Ï†ïÏÉÅÏ†ÅÏúºÎ°ú Î∞õÏïÑÏ°åÎäîÏßÄ ÌôïÏù∏Ìï¥Ïïº Ìï©ÎãàÎã§.<br></p>
      </div>
    </div>
  </div>
  </tbody>
</table>
<script>
    // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï≤´ Î≤àÏß∏ ÌÉ≠ÏùÑ ÌôúÏÑ±Ìôî
    document.addEventListener('DOMContentLoaded', function() {
        openTab(event, 'product_info');
    });

    function openTab(evt, tabName) {

        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }
</script>
<!-- Î¨∏Ïùò ÎÇ¥Ïó≠ Îì±Î°ù Ï°∞Ìöå ÏàòÏ†ï -->
<script>
    $(document).ready(function() {
        $("#inquiryTab").click(function (){
            loadInquiries('${productVO.p_name}');
        });

        $("#inquiryButton").click(function() {
            $("#inquiryForm").css("display", "block");
        });

        $(".close").click(function() {
            $("#inquiryForm").css("display", "none");
        });

        $("#btnSubmitInquiry").click(function() {
            submitInquiry();
        });
    });

    $(document).on("click", ".btn-edit", function() {
        var inquiryText = $(this).siblings(".inquiry-text").text().replace("Î¨∏Ïùò ÎÇ¥Ïö©: ", "");
        console.log("Î¨∏Ïùò ÏàòÏ†ï ÏßÑÏûÖ : " + inquiryText)
        $("#editInquiryTextarea").val(inquiryText);
        $("#editInquiryModal").css("display", "block");
    });

    $(".close").click(function() {
        // ...
        $("#editInquiryModal").css("display", "none");
    });

    function submitInquiry() {
        var inquiryText = $("#qnaTextarea").val();

        $.ajax({
            url: "/submitInquiry",
            type: "POST",
            data: {
                inquiryText: inquiryText,
                p_name : '${productVO.p_name}',
                sno : ${store.sno}
            },
            success: function(response) {
                alert("Îì±Î°ùÎêòÏóàÏäµÎãàÎã§.");

                // ÏûÖÎ†• ÌïÑÎìúÎ•º Ï¥àÍ∏∞Ìôî
                $("#qnaTextarea").val("");
                // Î™®Îã¨ Îã´Í∏∞
                $("#inquiryForm").css("display", "none");

                // Îì±Î°ùÎêú Î¨∏ÏùòÍ∏ÄÏùÑ Î∞îÎ°ú ÌëúÏãú
                var inquiryContent = $("<p>").text("Î¨∏Ïùò ÎÇ¥Ïö©: " + inquiryText).addClass("inquiry-text");
                var inquiryDate = $("<p>").text("Î¨∏Ïùò ÏùºÏãú: " + new Date().toLocaleString()).addClass("inquiry-date");
                var newInquiry = $("<div>").addClass("inquiry");
                newInquiry.append(inquiryContent, inquiryDate);
                $("#qnaList").append(newInquiry);

                // Îì±Î°ùÎêú Î¨∏ÏùòÍ∏ÄÏùò ÎÇ¥Ïö©ÏùÑ ÏÑúÎ≤ÑÎ°úÎ∂ÄÌÑ∞ Îã§Ïãú Î∞õÏïÑÏôÄÏÑú ÌôîÎ©¥Ïóê ÌëúÏãú
                loadInquiries('${productVO.p_name}');
            },
            error: function() {
                // ÏöîÏ≤≠Ïù¥ Ïã§Ìå®Ìïú Í≤ΩÏö∞, Ïò§Î•ò Ï≤òÎ¶¨
                console.error("ÏÉÅÌíà Î¨∏Ïùò Îì±Î°ùÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.");
            }
        });
    }

    function loadInquiries(p_name) {
        $.ajax({
            url: "/getInquiries",
            type: "GET",
            data: {
                p_name: p_name
            },
            dataType: "json", // JSON ÌòïÏãùÏùò ÏùëÎãµÏùÑ Í∏∞ÎåÄ
            success: function(response) {
                console.log("Ï°∞Ìöå : " + response)
                // Í∏∞Ï°¥Ïùò Î¨∏Ïùò Î™©Î°ùÏùÑ Ï¥àÍ∏∞Ìôî
                $("#qnaList").empty();

                if (response && response.length > 0) {
                    response.forEach(function(vo) {
                        console.log("Î¨∏Ïùò ÎÇ¥Ïö© : " + vo.u_inquiry)
                        console.log("Î¨∏Ïùò ÏùºÏãú : " + new Date(vo.inquiry_date).toLocaleString())
                        var inquiryContent = $("<p>").text("Î¨∏Ïùò ÎÇ¥Ïö©: " + vo.u_inquiry).addClass("inquiry-text");
                        var inquiryDate = $("<p>").text("Î¨∏Ïùò ÏùºÏãú: " + new Date(vo.inquiry_date).toLocaleString()).addClass("inquiry-date");
                        var editButton = $("<button>").text("ÏàòÏ†ï").addClass("btn-edit");
                        var newInquiry = $("<div>").addClass("inquiry");
                        newInquiry.append(inquiryContent, inquiryDate, editButton);
                        console.log("new :"+newInquiry.text())
                        $("#qnaList").append(newInquiry);
                    });
                } else {
                    $("#qnaList").text("Îì±Î°ùÎêú Î¨∏ÏùòÍ∞Ä ÏóÜÏäµÎãàÎã§.");
                }
            },
            error: function() {
                console.error("Î¨∏Ïùò Î™©Î°ùÏùÑ Í∞ÄÏ†∏Ïò§Îäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.");
            }
        });
    }

    function updateInquiry() {
        var editedInquiryText = $("#editInquiryTextarea").val();
        console.log("ÏàòÏ†ïÌï† Î¨∏Ïùò ÌÖçÏä§Ìä∏ : " + editedInquiryText)
        // ÏΩîÎìú ÏàòÏ†ï ÌïÑÏöî: Ìï¥Îãπ Î¨∏ÏùòÏùò ID ÎòêÎäî ÏãùÎ≥ÑÏûêÎ•º Í∞ÄÏ†∏ÏôÄÏÑú ÏÑúÎ≤ÑÎ°ú Ï†ÑÏÜ°

        $.ajax({
            url: "/updateInquiry",
            type: "POST",
            data: {
                // ino : ino,
                u_name: '${customerUserVO.u_name}', // ÏàòÏ†ïÌï† Î¨∏ÏùòÏùò ID ÎòêÎäî ÏãùÎ≥ÑÏûê
                u_inquiry : editedInquiryText
            },
            dataType: "json",
            success: function(response) {
                console.log("ÏùëÎãµ:"+response)
                alert("ÏàòÏ†ï ÎêòÏóàÏäµÎãàÎã§.")
                // if (response && response.length > 0) {
                //     response.forEach(function(vo) {
                //         var inquiryContent = $("<p>").text("Î¨∏Ïùò ÎÇ¥Ïö©: " + vo.u_inquiry).addClass("inquiry-text");
                //         var inquiryDate = $("<p>").text("Î¨∏Ïùò ÏùºÏãú: " + new Date(vo.inquiry_date).toLocaleString()).addClass("inquiry-date");
                //         var editButton = $("<button>").text("ÏàòÏ†ï").addClass("btn-edit");
                //         var newInquiry = $("<div>").addClass("inquiry");
                //         newInquiry.append(inquiryContent, inquiryDate, editButton);
                //         $("#qnaList").append(newInquiry);
                //     });
                // } else {
                //     $("#qnaList").text("Îì±Î°ùÎêú Î¨∏ÏùòÍ∞Ä ÏóÜÏäµÎãàÎã§.");
                // }
            },
            error: function() {
                console.error("Î¨∏Ïùò ÎÇ¥Ïö©ÏùÑ ÏàòÏ†ïÌïòÎäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.");
            }
        });

        $("#editInquiryModal").css("display", "none");
    }

</script>
<script>
    $(document).ready(function(e) {
        $('#endDate').on("change", function() {
            var startDate = new Date($("#startDate").val());
            var endDate = new Date($(this).val());
            var day = (endDate - startDate) / (1000 * 60 * 60 * 24); // Ïùº Îã®ÏúÑÎ°ú Í≥ÑÏÇ∞
            var totalPrice = (day+1) * ${productVO.p_price};
            console.log(totalPrice)
            $("#totalPrice").val(totalPrice);
        });
    });
</script>
<script>
    // Î°úÍ∑∏Ïù∏ Ïó¨Î∂Ä ÌôïÏù∏ Ìï®Ïàò
  function isLoggedIn() {
    // Î°úÍ∑∏Ïù∏ Ïó¨Î∂ÄÎ•º ÌôïÏù∏ÌïòÎäî ÏΩîÎìú ÏûëÏÑ±
    // Î°úÍ∑∏Ïù∏ÎêòÏñ¥ ÏûàÏúºÎ©¥ true Î∞òÌôò, ÏïÑÎãàÎ©¥ false Î∞òÌôò
    // ÏòàÏãú:
      if (${customerUserVO == null || customerUserVO.u_id == null}) {
      return false;
    } else {
      return true;
    }
  }
  $(document).ready(function (e) {
    $('#wishBtn').click(function (e) {
      var data_like = $("#wishBtn").text()
      // console.log("data_like : " + data_like)
      let f1 = $('#wishBtn').data('a');
      let f2 = $('#wishBtn').data('b');
      var flag = false
      if(data_like == "‚ù§Ô∏è"){
        deleteWishlist();
        if (($("#customerUserVO") != null || $("#u_id") != null)){
          flag = !flag
          $('#wishBtn').text("ü§ç");
          console.log('Ïó¨Í∏∞Îäî ÏÇ≠Ï†ú');
        }
      } else {
        addWishlist(f1, f2);
        if (($("#customerUserVO") != null || $("#u_id") != null)){
          flag = !flag
          $('#wishBtn').text("‚ù§Ô∏è");
          console.log('Ïó¨Í∏∞Îäî Ï∂îÍ∞Ä');
        }
      }
    });
  });
  function addWishlist(pno, u_id) {
    // Î°úÍ∑∏Ïù∏ Ïó¨Î∂Ä ÌôïÏù∏
    if (!isLoggedIn()) {
      alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
      return;
    }
      $.ajax({
          type: 'POST',
          url: "/wishlist/add",
          data: {
              pno,
              u_id
          },
          success: function(data) {
              alert("Ï∞ú Î™©Î°ùÏóê Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.");
          },
          error: function(request, status, error) {
              console.log("ÏóêÎü¨")
              alert(error);
          }
      });
  }

  function deleteWishlist() {
    // Î°úÍ∑∏Ïù∏ Ïó¨Î∂Ä ÌôïÏù∏
    if (!isLoggedIn()) {
      alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
      return;
    }

    $.ajax({
      type: "GET",
      url: "/wishlist/delete?pno="+${productVO.pno},
      success: function(data) {
        console.log("ÏÇ≠Ï†ú Îì§Ïñ¥Ïò§ÎÇò");
        alert("Ï∞ú Î™©Î°ùÏóêÏÑú ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.");
      },
      error: function (xhr, status, error) {
        alert(error);
      },
    });
  }
</script>
<script>
  $(document).ready(function (e) {
    $('#cartBtn').click(function (e) {
      var data_cart = $("#cartBtn").text()
      // console.log("data_like : " + data_like)
      var f3 = $('#cartBtn').data('c');
      var f4 = $('#cartBtn').data('d');
      var f5 = $('#totalPrice').val();
      var f6 = $("#startDate").val();
      var f7 = $("#endDate").val();
      console.log(f5,f6,f7)
      var flag = false
      if(data_cart == "üõí"){
        deleteCart();
        if (($("#customerUserVO") != null || $("#u_id") != null)){
          flag = !flag
          $('#cartBtn').text("Ïû•Î∞îÍµ¨ÎãàÎã¥Í∏∞");
          console.log('Ïó¨Í∏∞Îäî ÏÇ≠Ï†ú');
        }
      } else {
        addCart(f3, f4, f5, f6, f7);
        if (($("#customerUserVO") != null || $("#u_id") != null)){
          flag = !flag
          $('#cartBtn').text("üõí");
          console.log('Ïó¨Í∏∞Îäî Ï∂îÍ∞Ä');
        }
      }
    });
  });
  function addCart(pno, u_id, c_price, c_startDate, c_endDate) {
    // Î°úÍ∑∏Ïù∏ Ïó¨Î∂Ä ÌôïÏù∏
    if (!isLoggedIn()) {
      alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
      return;
    }

    var start = "";
    var end = "";

      $("#startDate").each(function(idx, input) {
          if ($(input).data("type") === "free" || $(input).data("type") === "fixed") {
              var date = c_startDate.split("-");
              start = date[0] + "ÎÖÑ " + date[1] + "Ïõî " + date[2] + "Ïùº";
          } else {
              start = c_startDate;
          }
      });

      $("#endDate").each(function(idx, input) {
          if ($(input).data("type") === "free" || $(input).data("type") === "fixed") {
              var date = c_endDate.split("-");
              end = date[0] + "ÎÖÑ " + date[1] + "Ïõî " + date[2] + "Ïùº";
          } else {
              end = c_endDate;
          }
      });
      var cartData = {
          'pno': pno,
          'u_id': u_id,
          'c_price': c_price,
          'c_startDate': start,
          'c_endDate': end,
      }
    $.ajax({
      type: 'POST',
      url: "/cart/add",
        data: JSON.stringify(cartData),
        contentType: "application/json; charset=utf8",
      success: function(data) {
        alert("Ïû•Î∞îÍµ¨ÎãàÏóê Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.");
      },
      error: function(request, status, error) {
        console.log("ÏóêÎü¨")
        alert(error);
      }
    });
  }


  function deleteCart() {
    // Î°úÍ∑∏Ïù∏ Ïó¨Î∂Ä ÌôïÏù∏
    if (!isLoggedIn()) {
      alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
      return;
    }

    $.ajax({
      type: "GET",
      url: "/cart/delete?pno="+${productVO.pno},
      success: function(data) {
        console.log("ÏÇ≠Ï†ú Îì§Ïñ¥Ïò§ÎÇò");
        alert("Ïû•Î∞îÍµ¨ÎãàÏóêÏÑú ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.");
      },
      error: function (xhr, status, error) {
        alert(error);
      },
    });
  }
</script>
<script>
    $(document).ready(function() {
        $("#buyBtn").click(function() {
            if (!isLoggedIn()) {
                alert("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî.");
                return;
            }
            var pno = ${productVO.pno};
            var p_price = $('#totalPrice').val();
            var startDate = $("#startDate").val(); // ÏÑ†ÌÉùÎêú ÏãúÏûë ÎÇ†Ïßú
            var endDate = $("#endDate").val(); // ÏÑ†ÌÉùÎêú Ï¢ÖÎ£å ÎÇ†Ïßú
            var url = "/board/buy?pno=" + pno + "&startDate=" + startDate + "&endDate=" + endDate + "&p_price=" + p_price; // Íµ¨Îß§ ÌéòÏù¥ÏßÄ URLÏóê ÏÑ†ÌÉùÎêú ÎÇ†ÏßúÏôÄ Í∞ÄÍ≤©ÏùÑ Ï∂îÍ∞ÄÌï©ÎãàÎã§.
            window.location.href = url;
        });
    });
</script>
</body>
<%@ include file="../footer/footer.jsp"%>

</html>